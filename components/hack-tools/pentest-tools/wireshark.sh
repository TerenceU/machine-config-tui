#!/bin/bash
# wireshark.sh - Install Wireshark

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")/../../.." && pwd)"
source "${SCRIPT_DIR}/lib/utils.sh"
source "${SCRIPT_DIR}/lib/package-manager.sh"

main() {
    log_info "Installing Wireshark..."
    
    install_official_packages wireshark-qt || {
        log_error "Failed to install wireshark"
        return 1
    }
    
    # Add user to wireshark group
    if gum confirm "Add your user to 'wireshark' group for packet capture?"; then
        sudo usermod -aG wireshark $USER
        log_success "User added to wireshark group (logout required)"
    fi
    
    log_success "Wireshark installed!"
    return 0
}

main "$@"
